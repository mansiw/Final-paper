---
title: "Youth Unemployment and Political Engagement"
author: "Tori Dykes & Mansi Wadhwa"
date: "12/15/2016"
output: html_document
---

```{r, echo=F, warning=F, message=F}

source('datacleaningpaper.R')

library(plotly)
library(dplyr)

```

## Introduction ##

Our research project looks at the relationship between youth unemployment and youth political engagement. We are interested in learning whether being unemployed make young people more politically aware and involved, or does it make them care less about politics and withdraw from political activities?

## Context ##

In the early 2000s, a global financial crisis slowly began to build, reaching a peak in 2008 and 2009. One of the most striking signs of this economic downturn was the increase in youth unemployment rates seen in many European countries. Nearly all European countries were affected, and many saw double-digit increases in their youth unemployment rates. 

In this context, some powerful protest movements began to emerge that made the issue of unemployment -- and especially youth unemployment -- a main focus. Southern European countries, which were some of the hardest-hit by the financial crisis, gave birth to some of the most famous movements, like Podemos in Spain and Syriza in Greece (Syriza existed prior to the 2008 - 2009 crisis but its profile increased signficantly afterward).

In the below graph, you can compare youth unemployment rates for 22 different European countries to see just how much the numbers changed from 2008 to 2010. The values measured are the percent of the active population (i.e., individuals who are part of the labor force) that is unemployed. 

```{r, results = 'asis', echo=F, warning=F, message=F}

Unemp0810 <- subset(eu, eu$TIME==2008 | eu$TIME==2010)

names(Unemp0810) <- c("TIME", "GEO", "AGE", "UNIT", "SEX", "Unemp.Rate", "Flag.and.Footnotes", "Country")

Unemp0810$TIME <- factor(Unemp0810$TIME) # Ensure year is treated as levels, not as continuous numbers

Unemp0810 <- group_by(Unemp0810, Country, TIME)

Unemp0810$Unemp.Rate <- as.numeric(as.character(Unemp0810$Unemp.Rate)) # Ensure all the unemployment value are numerics 

Unemp0810graph <- ggplot(data=Unemp0810, aes(x=Country, y=Unemp.Rate, fill=TIME)) + geom_bar(stat="identity", position=position_dodge()) + labs(x="Country", y="Unemployment Rate (% of active population)") + ggtitle("Youth Unemployment Rates in Europe, 2008 - 2010") + guides(fill = guide_legend(title = "Year"))

ggplotly(Unemp0810graph)

```


## Political Engagement Data ##

To look at the relationship between youth unemployment and youth political engagement, we relied on data from the European Social Survey, which is a representative survey of individuals in European countries that is conducted every two years, starting in 2002. Respondents are asked a variety of questions to guage their attitudes and perspectives on topics like politics, media, social issues, etc. Respondents are also asked a variety of demographic information, such as their age, sex, and employment status. 

The below graph gives a window into one of the ESS measures of political engagement, which is an idividual's level of political interest. This is measured on 1 to 4 scale, with 1 representing "very interested" in politics and 4 representing "not at all interested" in politics. The values in the graphs are the averages of the responses for all youths in a given country in a given year.  



```{r, echo = F, warning = F, message = F}
comparepolintr <- subset(YouthData, YouthData$cntry == "DE"|YouthData$cntry == "DK"|YouthData$cntry == "ES"|YouthData$cntry == "FR"|YouthData$cntry == "HU"|YouthData$cntry == "IE"|YouthData$cntry == "NL")

polintrplot <- ggplot(data = comparepolintr, aes(x=TIME, y=avgpolintr)) + geom_line(aes(colour=cntry)) + scale_x_continuous(breaks = c(2002, 2004, 2006, 2008, 2010, 2012), labels=c("2002","2004","2006","2008","2010","2012"), limits = c(2002,2012)) + labs(x="Years", y="Average Political Interest", color = "Countries") + ggtitle("Average Political Interest for Youth (Select Countries)") + guides(fill = guide_legend(title = "Countries"))

ggplotly(polintrplot)

```


To get a better idea of how a young person's level of political interest and their employment status are related, we did a simple regression to get estimates of the effect. The below chart looks at how the estimated level of political interest for a young person in Europe varies based on their education and their employment status.

In the below graph, a value of "0" (the red bars) means a person is employed. A value of "1" (the blue bars) means a person is unemployed.

The education levels on the bottom are arranged from least education to most education:

1 - Less than Secondary Education <br>
2 -Lower Secondary Education <br>
3 - Lower Tier Upper Secondary Education <br>
4 - Upper Tier Upper Secondary Education <br>
5 - Advanced Vocational Education <br>
6 - BA Degree (or equivalent) <br>
7 - MA Degree (or equivalent) <br>

```{r, warning=F, message=F, echo=F, results = 'asis'}

# Create dataframe of complete cases only

completepolintr <- subset(ESSData, complete.cases(ESSData$polintr, ESSData$unempdummy, ESSData$eisced))

lmpolintr2 <- lm(polintr ~ unempdummy + factor(eisced), data = completepolintr)

# Create dataframe with fitted values

fittedpolintr <- data.frame(Unemployed = completepolintr$unempdummy, Education = completepolintr$eisced, Fitted = fitted(lmpolintr2))

fittedpolintr$Fitted <- as.numeric(as.character(fittedpolintr$Fitted))

# Remove duplicate rows

fittedpolintr2 <- unique(fittedpolintr) # some duplicate rows persist...

# Manually remove remaining rows...

fittedpolintr2 <- fittedpolintr2[order(fittedpolintr2$Education),] 

rownames(fittedpolintr2) <- 1:nrow(fittedpolintr2)

fittedpolintr2 <- fittedpolintr2[c(1,2,4,8,9,10,11,12,17,18,20,22,23,24),]

# Set to factor

fittedpolintr2$Unemployed <- factor(fittedpolintr2$Unemployed)

fittedpolintr2$Education <- factor(fittedpolintr2$Education)

# Rename Education Levels

#fittedpolintr2$Education[fittedpolintr2$Education == 1] <- "Less than Secondary"
#fittedpolintr2$Education[fittedpolintr2$Education == 2] <- "Lower Secondary"
#fittedpolintr2$Education[fittedpolintr2$Education == 3] <- "Lower Tier Upper Secondary"
#fittedpolintr2$Education[fittedpolintr2$Education == 4] <- "Upper Tier Upper Secondary"
#fittedpolintr2$Education[fittedpolintr2$Education == 5] <- "Advanced Vocational"
#fittedpolintr2$Education[fittedpolintr2$Education == 6] <- "BA"
#fittedpolintr2$Education[fittedpolintr2$Education == 7] <- "MA"


# Create Graph

FittedPolIntrPlot <- ggplot(data=fittedpolintr2, aes(x=Education, y=Fitted, fill=Unemployed)) + geom_bar(stat="identity", position=position_dodge()) + labs(x="Education", y="Predicted Level of Political Interest") + ggtitle("Predicted Level of Political Interest") + theme(plot.margin = unit(c(1,4,1,1), "cm"), legend.title = element_text(size = 10)) + scale_fill_discrete(name="Employment <br> Status", breaks=c(0, 1), labels=c("Employed", "Unemployed")) 

# Labeling of legend values not working in plotly, does work for ggplot

ggplotly(FittedPolIntrPlot)



```

We can see from the graph that being unemployed does tend to lower your political interest (remember that with the 1 - 4 scale, a higher number means someone is less interested in politics) regardless of a person's level of education. 

``````{r, warning=F, message=F, echo=F, results = 'asis'}


voting <- glm(votedummy ~ unempdummy + gndr + factor(eisced) + stfdem, data = ESSData, family = 'binomial')

votingplot <- ggplot(ESSData, aes(x=unempdummy, y=votedummy)) + geom_point(shape=1, position=position_jitter(width=.01,height=.01)) + stat_smooth(method="glm", method.args=list(family="binomial"), se=FALSE) + labs(x="Unemployment Dummy", y="Likelihood of voting") + ggtitle("Effect of unemployment on voting behaviour")

ggplotly(votingplot)

```

## Conclusions ##

The effects we found in our regression (as well as in the additional regressions completed in our longer paper) are statistically significant, meaning we can say there is a real effect generated by being unemployed that can't be written away as random variation. Still, as seen in the above table, the actual amount of change as a result of being unemployed is not huge. For that reason, we can't say that that unemployment significantly impacts a young person's level of political interst, but we can say that, based our data and analysis, it definitely has an effect.

## Data Sources ##

- European Social Survey, Rounds 1 - 7 (2002 - 2014). Full dataset available for download here: http://www.europeansocialsurvey.org/downloadwizard/

- Eurostat, Unemployment by sex and age -- annual average (2006 - 2015). Full dataset available for viewing and downloading here: http://appsso.eurostat.ec.europa.eu/nui/show.do?dataset=une_rt_a&lang=en
